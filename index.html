<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ù„Ø¹ Ø¹Ø±Ø¨ÙŠØªÙƒ - Ù…ØªØ¬Ø± Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>
    <link rel="stylesheet" href="assets/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <meta name="description" content="Ø£ÙØ¶Ù„ Ù…ØªØ¬Ø± Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ Ù…ØµØ± - Ø¯Ù„Ø¹ Ø¹Ø±Ø¨ÙŠØªÙƒ">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="nav">
                <div class="logo">
                    <h1>ğŸš— Ø¯Ù„Ø¹ Ø¹Ø±Ø¨ÙŠØªÙƒ</h1>
                </div>
                <div class="nav-links">
                    <a href="index.html" class="active">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    <a href="cart.html" class="cart-link">
                        <span class="cart-icon">ğŸ›’</span>
                        Ø§Ù„Ø³Ù„Ø© <span id="cartCount" class="cart-count">0</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h2>Ø¯Ù„Ø¹ Ø¹Ø±Ø¨ÙŠØªÙƒ Ø¨Ø£ÙØ¶Ù„ Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</h2>
                <p>Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…ØªÙ†ÙˆØ¹Ø© Ù…Ù† Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©</p>
            </div>
        </div>
    </section>

    <!-- Search and Filter -->
    <section class="filters">
        <div class="container">
            <div class="filter-bar">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...">
                    <button id="searchBtn">ğŸ”</button>
                </div>
                <div class="filter-options">
                    <select id="categoryFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                    </select>
                    <select id="priceFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</option>
                        <option value="0-100">Ø£Ù‚Ù„ Ù…Ù† 100 Ø¬Ù†ÙŠÙ‡</option>
                        <option value="100-300">100 - 300 Ø¬Ù†ÙŠÙ‡</option>
                        <option value="300-500">300 - 500 Ø¬Ù†ÙŠÙ‡</option>
                        <option value="500+">Ø£ÙƒØ«Ø± Ù…Ù† 500 Ø¬Ù†ÙŠÙ‡</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products">
        <div class="container">
            <h2 class="section-title">Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§ Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
            <div id="loadingSpinner" class="loading">
                <div class="spinner"></div>
                <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</p>
            </div>
            <div id="productsGrid" class="products-grid"></div>
            <div id="noProducts" class="no-products" style="display: none;">
                <p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«</p>
            </div>
        </div>
    </section>

    <!-- Featured Products -->
    <section class="featured">
        <div class="container">
            <h2 class="section-title">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
            <div id="featuredGrid" class="products-grid"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Ø¯Ù„Ø¹ Ø¹Ø±Ø¨ÙŠØªÙƒ</h3>
                    <p>Ø£ÙØ¶Ù„ Ù…ØªØ¬Ø± Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ Ù…ØµØ±</p>
                </div>
                <div class="footer-section">
                    <h4>Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h4>
                    <ul>
                        <li><a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                        <li><a href="cart.html">Ø§Ù„Ø³Ù„Ø©</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h4>
                    <p>ğŸ“ 01234567890</p>
                    <p>ğŸ“§ info@dalewcarabitak.com</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Ø¯Ù„Ø¹ Ø¹Ø±Ø¨ÙŠØªÙƒ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
            </div>
        </div>
    </footer>

    <!-- Notification Toast -->
    <div id="toast" class="toast"></div>

    <script src="config.js"></script>
    <script src="assets/app.js"></script>
    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updateCartCount();
            loadProducts();
            initializeFilters();
        });

        // Load products from API
        async function loadProducts() {
            try {
                showSpinner(true);
                const response = await fetch(`${API_BASE}?action=products`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const products = await response.json();
                displayProducts(products);
                displayFeaturedProducts(products);
                populateCategoryFilter(products);
            } catch (error) {
                console.error('Error loading products:', error);
                showToast('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
            } finally {
                showSpinner(false);
            }
        }

        // Display products in grid
        function displayProducts(products, containerId = 'productsGrid') {
            const container = document.getElementById(containerId);
            
            if (!products || products.length === 0) {
                document.getElementById('noProducts').style.display = 'block';
                container.innerHTML = '';
                return;
            }
            
            document.getElementById('noProducts').style.display = 'none';
            
            container.innerHTML = products.map(product => `
                <div class="product-card" data-category="${product.category}" data-price="${product.price}">
                    <div class="product-image">
                        <div class="image-placeholder">
                            <p>${product.image_desc || 'ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬'}</p>
                        </div>
                        ${product.featured ? '<span class="featured-badge">Ù…Ù…ÙŠØ²</span>' : ''}
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-desc">${product.short_desc || ''}</p>
                        <div class="product-price">${product.price} ${STORE_CONFIG.currency}</div>
                        <div class="product-actions">
                            <button onclick="viewProduct('${product.id}')" class="btn btn-primary">
                                Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                            </button>
                            <button onclick="quickAddToCart('${product.id}', '${product.name}', ${product.price})" 
                                    class="btn btn-secondary">
                                Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Display featured products
        function displayFeaturedProducts(products) {
            const featured = products.filter(p => p.featured);
            if (featured.length > 0) {
                displayProducts(featured, 'featuredGrid');
            } else {
                document.querySelector('.featured').style.display = 'none';
            }
        }

        // Populate category filter
        function populateCategoryFilter(products) {
            const categories = [...new Set(products.map(p => p.category))].filter(Boolean);
            const categoryFilter = document.getElementById('categoryFilter');
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        // Initialize search and filters
        function initializeFilters() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            const categoryFilter = document.getElementById('categoryFilter');
            const priceFilter = document.getElementById('priceFilter');

            // Search functionality
            searchBtn.addEventListener('click', filterProducts);
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    filterProducts();
                }
            });

            // Filter functionality
            categoryFilter.addEventListener('change', filterProducts);
            priceFilter.addEventListener('change', filterProducts);
        }

        // Filter products based on search and filters
        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const priceFilter = document.getElementById('priceFilter').value;
            
            const productCards = document.querySelectorAll('.product-card');
            let visibleCount = 0;

            productCards.forEach(card => {
                const productName = card.querySelector('.product-name').textContent.toLowerCase();
                const productDesc = card.querySelector('.product-desc').textContent.toLowerCase();
                const productCategory = card.dataset.category;
                const productPrice = parseFloat(card.dataset.price);

                let show = true;

                // Search filter
                if (searchTerm && !productName.includes(searchTerm) && !productDesc.includes(searchTerm)) {
                    show = false;
                }

                // Category filter
                if (categoryFilter && productCategory !== categoryFilter) {
                    show = false;
                }

                // Price filter
                if (priceFilter) {
                    const [min, max] = priceFilter.split('-');
                    if (max === undefined && productPrice <= parseFloat(min)) {
                        show = false;
                    } else if (max && (productPrice < parseFloat(min) || productPrice > parseFloat(max))) {
                        show = false;
                    }
                }

                card.style.display = show ? 'block' : 'none';
                if (show) visibleCount++;
            });

            document.getElementById('noProducts').style.display = visibleCount === 0 ? 'block' : 'none';
        }

        // Quick add to cart
        function quickAddToCart(productId, productName, productPrice) {
            addToCart({
                id: productId,
                name: productName,
                price: productPrice,
                quantity: 1
            });
        }

        // View product details
        function viewProduct(productId) {
            window.location.href = `product.html?id=${productId}`;
        }

        // Show loading spinner
        function showSpinner(show) {
            document.getElementById('loadingSpinner').style.display = show ? 'flex' : 'none';
        }
    </script>
</body>
</html>